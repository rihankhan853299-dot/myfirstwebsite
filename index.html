<!doctype html>
<html>
  <head><meta charset="utf-8"><title>My ChatGPT</title>
    <style>
      body{font-family:system-ui;margin:0;display:flex;flex-direction:column;height:100vh}
      #chat{flex:1;overflow:auto;padding:16px;background:#f6f7f9}
      .msg{max-width:720px;margin:8px auto;padding:12px;border-radius:14px}
      .user{background:#dbeafe}
      .bot{background:#e5e7eb}
      form{display:flex;gap:8px;padding:12px;border-top:1px solid #e5e7eb}
      input,button{font-size:16px;padding:10px;border-radius:10px;border:1px solid #d1d5db}
      button{cursor:pointer}
    </style>
  </head>
  <body>
    <div id="chat"></div>
    <form id="form">
      <input id="inp" placeholder="Type your message..." autofocus style="flex:1">
      <button>Send</button>
    </form>
    <script>
      const API = "http://localhost:8000/chat";
      const chat = document.getElementById('chat');
      const form = document.getElementById('form');
      const inp  = document.getElementById('inp');
      const msgs = [{role:'system', content:'You are a helpful assistant. Reply in Hinglish if user mixes Hindi.'}];

      function push(role, content){
        const div=document.createElement('div');
        div.className='msg '+(role==='user'?'user':'bot');
        div.textContent=content;
        chat.appendChild(div); chat.scrollTop=chat.scrollHeight;
      }

      form.onsubmit = async (e)=>{
        e.preventDefault();
        const q = inp.value.trim(); if(!q) return;
        inp.value='';
        msgs.push({role:'user', content:q}); push('user', q);

        const r = await fetch(API, {method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({messages: msgs, stream:false})
        });
        const data = await r.json();
        const text = data.choices?.[0]?.message?.content || '(no reply)';
        msgs.push({role:'assistant', content:text});
        push('assistant', text);
      };
    </script>
  </body>
</html>
